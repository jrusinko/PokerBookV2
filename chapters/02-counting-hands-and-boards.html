<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Counting Hands and Boards – Mathematics of Poker</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/03-poker-as-a-probability-space.html" rel="next">
<link href="../chapters/01-poker-games-structure-and-language.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-d9ea66fcd6c317012447f26e9c021348.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/02-counting-hands-and-boards.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Counting Hands and Boards</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Mathematics of Poker</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Mathematics of Poker</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-poker-games-structure-and-language.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Poker Games, Structure, and Language</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-counting-hands-and-boards.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Counting Hands and Boards</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-poker-as-a-probability-space.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Poker as a Probability Space</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-random-variables-expectation-and-variance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Random Variables, Expectation, and Variance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-conditional-probability-and-bayes-rule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Conditional Probability and Bayes’ Rule</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-expected-value-in-multi-stage-decisions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Expected Value in Multi-Stage Decisions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-inference-with-discrete-distributions-ranges-and-blockers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference with Discrete Distributions: Ranges and Blockers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-zero-sum-games-and-mixed-strategies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Motivating Example</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-nash-equilibrium-and-indifference-conditions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Nash Equilibrium and Indifference Conditions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/10-exploitative-play-vs-equilibrium-thinking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exploitative Play vs Equilibrium Thinking</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/11-betting-as-optimization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Betting as Optimization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/12-the-value-of-information.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Value of Information</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/13-tournament-poker-and-icm-optimization-with-nonlinear-utility.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Tournament Poker and ICM: Optimization with Nonlinear Utility</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/14-game-trees-and-abstraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Test</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/15-learning-equilibria-regret-minimization-and-solvers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Learning Equilibria: Regret Minimization and Solvers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/16-alternative-solver-perspectives-lp-qre-and-regularization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Alternative Solver Perspectives: LP, QRE, and Regularization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/17-variance-bankroll-and-risk-of-ruin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Variance, Bankroll, and Risk of Ruin</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/18-randomness-shuffling-rngs-and-verification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Randomness, Shuffling, RNGs, and Verification</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/19-learning-from-data-hand-histories-and-statistical-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Learning from Data: Hand Histories and Statistical Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/20-detecting-cheating-and-collusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Detecting Cheating and Collusion</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#motivating-example" id="toc-motivating-example" class="nav-link active" data-scroll-target="#motivating-example"><span class="header-section-number">3.1</span> Motivating Example</a>
  <ul class="collapse">
  <li><a href="#a-vivid-historical-puzzle-straights-flushes-and-how-poker-learned-to-count" id="toc-a-vivid-historical-puzzle-straights-flushes-and-how-poker-learned-to-count" class="nav-link" data-scroll-target="#a-vivid-historical-puzzle-straights-flushes-and-how-poker-learned-to-count"><span class="header-section-number">3.1.1</span> A Vivid Historical Puzzle: Straights, Flushes, and How Poker Learned to Count</a></li>
  </ul></li>
  <li><a href="#mathematical-framework-and-poker-theory" id="toc-mathematical-framework-and-poker-theory" class="nav-link" data-scroll-target="#mathematical-framework-and-poker-theory"><span class="header-section-number">3.2</span> Mathematical Framework and Poker Theory</a>
  <ul class="collapse">
  <li><a href="#roadmap" id="toc-roadmap" class="nav-link" data-scroll-target="#roadmap"><span class="header-section-number">3.2.1</span> Roadmap</a></li>
  </ul></li>
  <li><a href="#combinations-and-permutations" id="toc-combinations-and-permutations" class="nav-link" data-scroll-target="#combinations-and-permutations"><span class="header-section-number">3.3</span> Combinations and Permutations</a>
  <ul class="collapse">
  <li><a href="#a-motivating-example-dealing-cards" id="toc-a-motivating-example-dealing-cards" class="nav-link" data-scroll-target="#a-motivating-example-dealing-cards"><span class="header-section-number">3.3.1</span> A Motivating Example: Dealing Cards</a></li>
  <li><a href="#permutations-counting-ordered-outcomes" id="toc-permutations-counting-ordered-outcomes" class="nav-link" data-scroll-target="#permutations-counting-ordered-outcomes"><span class="header-section-number">3.3.2</span> Permutations: Counting Ordered Outcomes</a></li>
  <li><a href="#combinations-counting-unordered-selections" id="toc-combinations-counting-unordered-selections" class="nav-link" data-scroll-target="#combinations-counting-unordered-selections"><span class="header-section-number">3.3.3</span> Combinations: Counting Unordered Selections</a></li>
  <li><a href="#why-this-distinction-matters-in-poker" id="toc-why-this-distinction-matters-in-poker" class="nav-link" data-scroll-target="#why-this-distinction-matters-in-poker"><span class="header-section-number">3.3.4</span> Why This Distinction Matters in Poker</a></li>
  <li><a href="#worked-example-ideas" id="toc-worked-example-ideas" class="nav-link" data-scroll-target="#worked-example-ideas"><span class="header-section-number">3.3.5</span> Worked example ideas</a></li>
  <li><a href="#worked-example-counting-all-deals-and-runouts-in-6-handed-texas-holdem" id="toc-worked-example-counting-all-deals-and-runouts-in-6-handed-texas-holdem" class="nav-link" data-scroll-target="#worked-example-counting-all-deals-and-runouts-in-6-handed-texas-holdem"><span class="header-section-number">3.3.6</span> Worked Example: Counting All Deals and Runouts in 6-Handed Texas Hold’em</a></li>
  <li><a href="#worked-example-counting-via-the-complement" id="toc-worked-example-counting-via-the-complement" class="nav-link" data-scroll-target="#worked-example-counting-via-the-complement"><span class="header-section-number">3.3.7</span> Worked Example: Counting via the Complement</a></li>
  <li><a href="#example-counting-five-card-hands-with-at-least-one-pair" id="toc-example-counting-five-card-hands-with-at-least-one-pair" class="nav-link" data-scroll-target="#example-counting-five-card-hands-with-at-least-one-pair"><span class="header-section-number">3.3.8</span> Example: Counting Five-Card Hands with At Least One Pair</a></li>
  <li><a href="#structural-insight" id="toc-structural-insight" class="nav-link" data-scroll-target="#structural-insight"><span class="header-section-number">3.3.9</span> Structural Insight</a></li>
  </ul></li>
  <li><a href="#inclusionexclusion-correcting-overcounts" id="toc-inclusionexclusion-correcting-overcounts" class="nav-link" data-scroll-target="#inclusionexclusion-correcting-overcounts"><span class="header-section-number">3.4</span> Inclusion–Exclusion: Correcting Overcounts</a>
  <ul class="collapse">
  <li><a href="#motivating-example-one-exclusion-step" id="toc-motivating-example-one-exclusion-step" class="nav-link" data-scroll-target="#motivating-example-one-exclusion-step"><span class="header-section-number">3.4.1</span> Motivating Example: One Exclusion Step</a></li>
  <li><a href="#two-exclusion-steps-overlapping-conditions" id="toc-two-exclusion-steps-overlapping-conditions" class="nav-link" data-scroll-target="#two-exclusion-steps-overlapping-conditions"><span class="header-section-number">3.4.2</span> Two Exclusion Steps: Overlapping Conditions</a></li>
  <li><a href="#the-general-inclusionexclusion-principle" id="toc-the-general-inclusionexclusion-principle" class="nav-link" data-scroll-target="#the-general-inclusionexclusion-principle"><span class="header-section-number">3.4.3</span> The General Inclusion–Exclusion Principle</a></li>
  <li><a href="#proof-by-induction" id="toc-proof-by-induction" class="nav-link" data-scroll-target="#proof-by-induction"><span class="header-section-number">3.4.4</span> Proof by Induction</a></li>
  <li><a href="#computer-science-valid-states-in-a-sea-of-possibilities" id="toc-computer-science-valid-states-in-a-sea-of-possibilities" class="nav-link" data-scroll-target="#computer-science-valid-states-in-a-sea-of-possibilities"><span class="header-section-number">3.4.5</span> Computer Science: Valid States in a Sea of Possibilities</a></li>
  <li><a href="#a-shared-mathematical-spine" id="toc-a-shared-mathematical-spine" class="nav-link" data-scroll-target="#a-shared-mathematical-spine"><span class="header-section-number">3.4.6</span> A Shared Mathematical Spine</a></li>
  </ul></li>
  <li><a href="#liberal-arts-sidebar" id="toc-liberal-arts-sidebar" class="nav-link" data-scroll-target="#liberal-arts-sidebar"><span class="header-section-number">3.5</span> Liberal Arts Sidebar</a></li>
  <li><a href="#homework-problems" id="toc-homework-problems" class="nav-link" data-scroll-target="#homework-problems"><span class="header-section-number">3.6</span> Homework Problems</a></li>
  <li><a href="#extension-activity" id="toc-extension-activity" class="nav-link" data-scroll-target="#extension-activity"><span class="header-section-number">3.7</span> Extension Activity</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Counting Hands and Boards</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="motivating-example" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="motivating-example"><span class="header-section-number">3.1</span> Motivating Example</h2>
<p><img src="images/clipboard-962570957.png" class="img-fluid"></p>
<section id="a-vivid-historical-puzzle-straights-flushes-and-how-poker-learned-to-count" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="a-vivid-historical-puzzle-straights-flushes-and-how-poker-learned-to-count"><span class="header-section-number">3.1.1</span> A Vivid Historical Puzzle: Straights, Flushes, and How Poker Learned to Count</h3>
<p>In the 1830s and 1840s, a poker game in New Orleans, St.&nbsp;Louis, or on a Mississippi riverboat did not begin with a shared rule sheet. It began with a deck of cards, a table, and a set of assumptions negotiated—sometimes explicitly, sometimes by habit—among the people sitting down to play. What counted as a “strong” hand depended less on abstract theory than on what players had learned, by repetition, to fear.</p>
<p>Many of these games were not played with the now-standard 52-card deck. In <strong>20-card poker</strong>, still common on riverboats and in frontier settings, only the tens through aces were used. Four players received five cards each, and the deck was exhausted every hand. In this environment, the mathematics of patterns is stark. There are no low cards to extend sequences, and suit structure plays almost no role at all. Straights are extremely limited, flushes effectively meaningless, and the drama of the game centers on matched ranks. A player showing strength is signaling <em>duplication</em>, not order or color. When later generations encountered full-deck poker, they did so carrying habits formed in this earlier, rank-dominated world.</p>
<p>As poker spread inland and westward, decks expanded to 32 cards and then to the full 52. Five-card draw emerged as a dominant format, particularly in Southern and Midwestern gambling culture. These were not static games. Players drew cards, discarded, and bet again. What mattered most was not how a hand would rank if completed, but how it might <em>improve</em>. A player holding four cards to a hand was visibly dangerous.</p>
<p>Here the straight–flush controversy becomes vivid. A player with four consecutive ranks—say 7-8-9-10—could complete a straight with any six or jack, in any suit: eight possible cards. A player with four hearts needed any remaining heart: nine possible cards. Around the table, this difference was felt immediately. Flushes arrived more often <em>from the draw</em>. In saloons from Natchez to Memphis, players noticed this and drew conclusions. If a flush is easier to make, why should it beat a straight?</p>
<p>Some regional rule sets answered: it shouldn’t. In parts of the South, straights were sometimes ranked above flushes, especially when ace-high sequences were involved. Other tables compromised, declaring straights and flushes equal, with ties broken by high card alone. Still others introduced special cases: ace-high flushes were premium, but lesser flushes could lose to high straights. These were not theoretical debates. They were practical responses to what players saw unfold hand after hand.</p>
<p>Further west, especially during the California Gold Rush, poker tables mixed players from radically different traditions. Eastern card-room players, accustomed to games like <strong>brag</strong> and <strong>primero</strong>, brought with them an emphasis on fixed, categorical hand values. In these games, rarity and symbolic hierarchy mattered more than draw dynamics. A hand either <em>was</em> a certain type or it was not. This perspective made flushes feel more substantial: they required uniformity across suits, a feature not easily replicated by chance.</p>
<p>Even the definition of a straight was unstable. In some games, the ace could appear only above a king. In others, it could wrap around to form A-2-3-4-5. Some tables allowed both, some neither. The number of ways to make a straight—and thus its perceived strength—shifted accordingly. Flushes, by contrast, were insensitive to rank conventions but highly sensitive to deck composition and redraw rules. Depending on local choices, the balance could tip either way.</p>
<p>What ultimately resolved the debate was not improved intuition but a change in perspective. As poker moved into casinos and formal tournaments in the late nineteenth and early twentieth centuries, games increasingly involved strangers who needed shared expectations. Rulebooks sought consistency across formats, not just fairness at a single table. This forced a different mathematical question to the foreground: among all possible five-card hands, which patterns are genuinely rarer?</p>
<p>When counted globally—rather than experienced locally from four-card near-misses—flushes occur less often than straights. The nine-versus-eight draw comparison, so vivid in five-card draw, conditions on a specific partial holding. The overall frequency calculation does not. The modern hierarchy silently encodes this shift from <em>situational probability</em> to <em>combinatorial frequency</em>.</p>
<p>This historical arc gives substance to what might otherwise seem like an arbitrary rule. Flushes outrank straights not because early players failed to notice how draws worked, but because poker eventually learned to privilege total rarity over local ease. The disagreement itself is the point. It marks the moment where intuition, experience, and mathematics begin to pull apart—and where careful counting becomes necessary to hold the game together.</p>
<p>That tension will guide the mathematics of this chapter. Before we count, we must understand why counting was not always the obvious thing to do.</p>
</section>
</section>
<section id="mathematical-framework-and-poker-theory" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="mathematical-framework-and-poker-theory"><span class="header-section-number">3.2</span> Mathematical Framework and Poker Theory</h2>
<section id="roadmap" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="roadmap"><span class="header-section-number">3.2.1</span> Roadmap</h3>
<ul>
<li>Counting principles (sum/product)</li>
<li>Counting poker hands (5-card and Hold’em contexts)</li>
<li>Complement and inclusion–exclusion</li>
<li>From counting to probabilities</li>
</ul>
</section>
</section>
<section id="combinations-and-permutations" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="combinations-and-permutations"><span class="header-section-number">3.3</span> Combinations and Permutations</h2>
<p>A standard deck of playing cards contains 52 distinct objects. This simple fact hides a subtle mathematical question that will recur throughout this chapter:</p>
<blockquote class="blockquote">
<p><em>In how many essentially different ways can cards be selected or arranged?</em></p>
</blockquote>
<p>Poker forces us to confront this question immediately, because not all distinctions between cards matter equally. Sometimes the <em>order</em> in which cards appear is crucial; sometimes it is irrelevant. The mathematics of permutations and combinations formalizes this distinction.</p>
<section id="a-motivating-example-dealing-cards" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="a-motivating-example-dealing-cards"><span class="header-section-number">3.3.1</span> A Motivating Example: Dealing Cards</h3>
<p>Imagine a dealer distributing five cards, one at a time, face down, to a single player. From the dealer’s perspective, the order of the cards matters: receiving the ace of spades first and the king of hearts second is a different physical process than receiving them in the opposite order. If we were to record the deal step by step, each outcome would be an <em>ordered sequence</em> of five distinct cards drawn from the deck.</p>
<p>By contrast, from the player’s perspective, the order is immaterial.A hand containing</p>
<p><span class="math display"> {\text{A}\spadesuit,&nbsp;\text{K}\heartsuit,&nbsp;\text{7}\diamondsuit,&nbsp;\text{7}\clubsuit,&nbsp;\text{2}\spadesuit} </span></p>
<p>is the same hand regardless of the sequence in which those cards were dealt.Poker hand rankings depend only on <em>which cards</em> are present, not on how they arrived.</p>
<p>This tension—between processes that care about order and outcomes that do not—is exactly what separates permutations from combinations.</p>
</section>
<section id="permutations-counting-ordered-outcomes" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="permutations-counting-ordered-outcomes"><span class="header-section-number">3.3.2</span> Permutations: Counting Ordered Outcomes</h3>
<p>We begin with the most order-sensitive setting.</p>
<p><strong>Definition (Permutation).</strong><br>
A <em>permutation</em> of (k) objects chosen from a set of (n) distinct objects is an ordered selection of (k) distinct elements.</p>
<p>Returning to the dealing example, suppose we want to count the number of possible <em>five-card sequences</em> that could be dealt from a 52-card deck, without replacement. The first card can be any of 52 cards. After it is dealt, 51 remain for the second card, then 50 for the third, and so on. By the multiplication principle, the total number of such sequences is</p>
<p><span class="math display"> 52 \cdot 51 \cdot 50 \cdot 49 \cdot 48. </span></p>
<p>To streamline notation, we introduce factorials.</p>
<p><strong>Definition (Factorial).</strong><br>
For a positive integer (n), the factorial of (n), denoted (n!), is defined by <span class="math display"> n! = n \cdot (n-1) \cdot (n-2) \cdots 2 \cdot 1, </span></p>
<p>with the convention (0! = 1).</p>
<p>Using factorials, the number of permutations of (k) objects chosen from (n) distinct objects is</p>
<p><span class="math display"> P(n,k) = \frac{n!}{(n-k)!}. </span></p>
<p>In our example,</p>
<p><span class="math display"> P(52,5) = \frac{52!}{47!} = 52 \cdot 51 \cdot 50 \cdot 49 \cdot 48, </span></p>
<p>which counts all possible ordered five-card deals.</p>
<p>Permutations are the natural counting tool whenever <em>order reflects meaningful information</em>: shuffling a deck, dealing cards sequentially, or seating players around a table.</p>
</section>
<section id="combinations-counting-unordered-selections" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="combinations-counting-unordered-selections"><span class="header-section-number">3.3.3</span> Combinations: Counting Unordered Selections</h3>
<p>Poker hands, however, do not remember order. The hand is defined only by its contents.</p>
<p><strong>Definition (Combination).</strong><br>
A <em>combination</em> of (k) objects chosen from a set of (n) distinct objects is an unordered selection of (k) distinct elements.</p>
<p>To count five-card poker hands, we must correct for overcounting. Each unordered hand corresponds to many different ordered sequences—one for each possible ordering of its five cards. Since there are (5!) ways to order five distinct cards, every poker hand is counted (5!) times in the permutation count (P(52,5)).</p>
<p>Dividing out this redundancy yields the number of distinct five-card hands:</p>
<p><span class="math display">
\binom{52}{5} = \frac{52!}{5! \, 47!}.
</span></p>
<p>The notation <span class="math inline">\binom{n}{k}</span>, read “(n) choose (k),” denotes the number of combinations of (k) objects selected from (n).</p>
<p>More generally,</p>
<p><span class="math display">
\binom{n}{k} = \frac{n!}{k!(n-k)!}.
</span></p>
<p>This expression is symmetric in (k) and (n-k), reflecting a simple but powerful idea: choosing (k) cards to include is equivalent to choosing (n-k) cards to exclude.</p>
</section>
<section id="why-this-distinction-matters-in-poker" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="why-this-distinction-matters-in-poker"><span class="header-section-number">3.3.4</span> Why This Distinction Matters in Poker</h3>
<p>The difference between permutations and combinations is not a technicality—it determines which questions we are answering.</p>
<ul>
<li>When we analyze <em>procedures</em> (shuffling, dealing, drawing), permutations naturally arise.</li>
<li>When we analyze <em>outcomes</em> (hand rankings, probabilities of flushes or straights), combinations are the appropriate tool.</li>
</ul>
<p>Much of the historical confusion surrounding hand values can be traced to implicit shifts between these perspectives. Players reasoned from the lived experience of draws—ordered processes unfolding over time—while hand rankings ultimately depend on unordered collections of cards.</p>
<p>In the sections that follow, we will use combinations to count specific classes of poker hands and to compare their frequencies. The formulas introduced here will serve as our basic counting language. What remains is to learn how to deploy them carefully—and how to recognize when naïve counting obscures more structure than it reveals.</p>
</section>
<section id="worked-example-ideas" class="level3" data-number="3.3.5">
<h3 data-number="3.3.5" class="anchored" data-anchor-id="worked-example-ideas"><span class="header-section-number">3.3.5</span> Worked example ideas</h3>
</section>
<section id="worked-example-counting-all-deals-and-runouts-in-6-handed-texas-holdem" class="level3" data-number="3.3.6">
<h3 data-number="3.3.6" class="anchored" data-anchor-id="worked-example-counting-all-deals-and-runouts-in-6-handed-texas-holdem"><span class="header-section-number">3.3.6</span> Worked Example: Counting All Deals and Runouts in 6-Handed Texas Hold’em</h3>
<p>Fix a six-handed table with labeled seats (for example: UTG, HJ, CO, BTN, SB, BB). We ask:</p>
<blockquote class="blockquote">
<p>How many distinct ways can the dealer assign hole cards to all six players and then deal a flop, turn, and river?</p>
</blockquote>
<p>We assume: - A standard 52-card deck. - Each player receives 2 private cards. - The flop consists of 3 community cards (unordered as a set). - The turn is a single card, then the river is a single card (these streets occur in order).</p>
<section id="step-1-deal-hole-cards-to-six-labeled-players" class="level4" data-number="3.3.6.1">
<h4 data-number="3.3.6.1" class="anchored" data-anchor-id="step-1-deal-hole-cards-to-six-labeled-players"><span class="header-section-number">3.3.6.1</span> Step 1: Deal hole cards to six labeled players</h4>
<p>Start with 52 cards.</p>
<ul>
<li>UTG receives <span class="math inline">\binom{52}{2}</span> possible hole-card sets.</li>
<li>HJ then receives <span class="math inline">\binom{50}{2}</span>.</li>
<li>CO receives <span class="math inline">\binom{48}{2}</span>.</li>
<li>BTN receives <span class="math inline">\binom{46}{2}</span>.</li>
<li>SB receives <span class="math inline">\binom{44}{2}</span>.</li>
<li>BB receives <span class="math inline">\binom{42}{2}</span>.</li>
</ul>
<p>After hole cards are dealt, <span class="math inline">52-12=40</span> cards remain.</p>
<p>So the number of hole-card assignments is <span class="math display">
\binom{52}{2}\binom{50}{2}\binom{48}{2}\binom{46}{2}\binom{44}{2}\binom{42}{2}.
</span></p>
</section>
<section id="step-2-deal-the-board-flop-turn-river" class="level4" data-number="3.3.6.2">
<h4 data-number="3.3.6.2" class="anchored" data-anchor-id="step-2-deal-the-board-flop-turn-river"><span class="header-section-number">3.3.6.2</span> Step 2: Deal the board (flop, turn, river)</h4>
<p>From the remaining 40 cards:</p>
<ul>
<li>Flop: choose 3 cards, <span class="math inline">\binom{40}{3}</span>.</li>
<li>Turn: choose 1 from the remaining 37 cards, giving a factor of <span class="math inline">37</span>.</li>
<li>River: choose 1 from the remaining 36 cards, giving a factor of <span class="math inline">36</span>.</li>
</ul>
<p>So the number of possible runouts is <span class="math display">
\binom{40}{3}\cdot 37 \cdot 36.
</span></p>
</section>
<section id="step-3-multiply" class="level4" data-number="3.3.6.3">
<h4 data-number="3.3.6.3" class="anchored" data-anchor-id="step-3-multiply"><span class="header-section-number">3.3.6.3</span> Step 3: Multiply</h4>
<p>Multiplying hole-card assignments by board runouts gives the total number of distinct “full deals” (six labeled players + flop/turn/river): <span class="math display">
\binom{52}{2}\binom{50}{2}\binom{48}{2}\binom{46}{2}\binom{44}{2}\binom{42}{2}
\;\binom{40}{3}\;37\;36.
</span></p>
<p>A direct computation gives <span class="math display">
\binom{52}{2}\binom{50}{2}\binom{48}{2}\binom{46}{2}\binom{44}{2}\binom{42}{2}
\;\binom{40}{3}\;37\;36
= 20{,}327{,}525{,}731{,}521{,}460{,}932{,}480{,}000,
</span> which is about <span class="math inline">2.03\times 10^{25}</span> possibilities.</p>
</section>
<section id="optional-variant-if-you-care-about-the-exact-dealing-order-of-the-17-cards" class="level4" data-number="3.3.6.4">
<h4 data-number="3.3.6.4" class="anchored" data-anchor-id="optional-variant-if-you-care-about-the-exact-dealing-order-of-the-17-cards"><span class="header-section-number">3.3.6.4</span> Optional variant: if you care about the <em>exact dealing order</em> of the 17 cards</h4>
<p>Sometimes we want to treat the entire deal as an ordered sequence of cards: the first hole card to UTG, second hole card to UTG, …, down to the river. That counts <strong>ordered sequences</strong> of 17 distinct cards: <span class="math display">
P(52,17)=\frac{52!}{35!}.
</span></p>
<p>This number is larger because it distinguishes: - the order of the two hole cards within each player’s hand (a factor of <span class="math inline">(2!)^6</span>), and - the order of the three flop cards (a factor of <span class="math inline">3!</span>).</p>
<p>Indeed, <span class="math display">
P(52,17)
=
\left(\binom{52}{2}\binom{50}{2}\cdots\binom{42}{2}\binom{40}{3}37\cdot 36\right)\,(2!)^6(3!).
</span> Numerically, this is approximately</p>
<p><span class="math display">
P(52,17) \approx 7.4 \times 10^{28},
</span></p>
<p>which is larger than the previous count because it distinguishes the internal order of each player’s hole cards and the order of cards within the flop. This keeps the comparison sharp, quantitative, and conceptually aligned with the chapter’s emphasis on modeling choices (ordered processes versus unordered outcomes), without reopening the derivation.</p>
</section>
</section>
<section id="worked-example-counting-via-the-complement" class="level3" data-number="3.3.7">
<h3 data-number="3.3.7" class="anchored" data-anchor-id="worked-example-counting-via-the-complement"><span class="header-section-number">3.3.7</span> Worked Example: Counting via the Complement</h3>
<p>In many counting problems, a collection of objects can be described in multiple ways. Some descriptions lead naturally to complicated casework, while others suggest a much simpler approach.</p>
<p>A powerful technique in such situations is <strong>counting via the complement</strong>.</p>
<section id="the-complement-principle-counting-form" class="level4" data-number="3.3.7.1">
<h4 data-number="3.3.7.1" class="anchored" data-anchor-id="the-complement-principle-counting-form"><span class="header-section-number">3.3.7.1</span> The Complement Principle (Counting Form)</h4>
<p>Let <span class="math inline">U</span> be a finite set, and let <span class="math inline">A \subseteq U</span>. If <span class="math inline">A^c</span> denotes the complement of <span class="math inline">A</span> in <span class="math inline">U</span> (that is, all elements of <span class="math inline">U</span> not in <span class="math inline">A</span>), then</p>
<p><span class="math display">
|A| = |U| - |A^c|.
</span></p>
<p>The usefulness of this principle depends entirely on which of <span class="math inline">A</span> or <span class="math inline">A^c</span> is easier to describe and count.</p>
<hr>
</section>
</section>
<section id="example-counting-five-card-hands-with-at-least-one-pair" class="level3" data-number="3.3.8">
<h3 data-number="3.3.8" class="anchored" data-anchor-id="example-counting-five-card-hands-with-at-least-one-pair"><span class="header-section-number">3.3.8</span> Example: Counting Five-Card Hands with At Least One Pair</h3>
<p>We count the number of five-card poker hands that contain <strong>at least one repeated rank</strong>. Rather than counting such hands directly, we count their complement.</p>
<section id="step-1-count-all-five-card-hands" class="level4" data-number="3.3.8.1">
<h4 data-number="3.3.8.1" class="anchored" data-anchor-id="step-1-count-all-five-card-hands"><span class="header-section-number">3.3.8.1</span> Step 1: Count all five-card hands</h4>
<p>The set of all five-card hands drawn from a standard 52-card deck has size</p>
<p><span class="math display">
|U| = \binom{52}{5}.
</span></p>
</section>
<section id="step-2-describe-the-complement" class="level4" data-number="3.3.8.2">
<h4 data-number="3.3.8.2" class="anchored" data-anchor-id="step-2-describe-the-complement"><span class="header-section-number">3.3.8.2</span> Step 2: Describe the complement</h4>
<p>The complement consists of all five-card hands in which <strong>all ranks are distinct</strong>. That is, no rank appears more than once.</p>
<p>This description includes: - high-card hands, - straights, - flushes, - straight flushes,</p>
<p>but excludes every hand containing a pair or better.</p>
</section>
<section id="step-3-count-the-complement" class="level4" data-number="3.3.8.3">
<h4 data-number="3.3.8.3" class="anchored" data-anchor-id="step-3-count-the-complement"><span class="header-section-number">3.3.8.3</span> Step 3: Count the complement</h4>
<p>To count hands with all distinct ranks:</p>
<ol type="1">
<li><p>Choose <span class="math inline">5</span> distinct ranks from the <span class="math inline">13</span> available: <span class="math display">
\binom{13}{5}.
</span></p></li>
<li><p>For each chosen rank, independently choose one of <span class="math inline">4</span> suits: <span class="math display">
4^5.
</span></p></li>
</ol>
<p>Thus, the number of five-card hands with no repeated ranks is</p>
<p><span class="math display">
|A^c| = \binom{13}{5} \cdot 4^5.
</span></p>
</section>
<section id="step-4-subtract" class="level4" data-number="3.3.8.4">
<h4 data-number="3.3.8.4" class="anchored" data-anchor-id="step-4-subtract"><span class="header-section-number">3.3.8.4</span> Step 4: Subtract</h4>
<p>The number of five-card hands containing <strong>at least one pair</strong> is therefore</p>
<p><span class="math display">
|A|
=
\binom{52}{5}
-
\binom{13}{5} \cdot 4^5.
</span></p>
<hr>
</section>
</section>
<section id="structural-insight" class="level3" data-number="3.3.9">
<h3 data-number="3.3.9" class="anchored" data-anchor-id="structural-insight"><span class="header-section-number">3.3.9</span> Structural Insight</h3>
<p>A direct count of hands with at least one pair would require separate enumeration of: - exactly one pair, - two pair, - three of a kind, - full house, - four of a kind.</p>
<p>The complement method avoids this case-by-case explosion by identifying a simpler description of what is <em>not</em> allowed.</p>
<p>This technique will recur throughout the chapter. Whenever a counting problem threatens to fragment into many overlapping cases, the first question to ask is not “how do I count this directly?” but rather</p>
<blockquote class="blockquote">
<p><em>What is the simplest collection of objects that I can count instead?</em></p>
</blockquote>
</section>
</section>
<section id="inclusionexclusion-correcting-overcounts" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="inclusionexclusion-correcting-overcounts"><span class="header-section-number">3.4</span> Inclusion–Exclusion: Correcting Overcounts</h2>
<p>Counting by the complement avoids difficult casework by counting what <em>does not</em> happen. Inclusion–exclusion addresses a different but equally common problem: <strong>overcounting</strong>.</p>
<p>It arises whenever objects may satisfy more than one condition simultaneously.</p>
<hr>
<section id="motivating-example-one-exclusion-step" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="motivating-example-one-exclusion-step"><span class="header-section-number">3.4.1</span> Motivating Example: One Exclusion Step</h3>
<section id="example-hands-containing-at-least-one-ace" class="level4" data-number="3.4.1.1">
<h4 data-number="3.4.1.1" class="anchored" data-anchor-id="example-hands-containing-at-least-one-ace"><span class="header-section-number">3.4.1.1</span> Example: Hands Containing at Least One Ace</h4>
<p>Let <span class="math inline">U</span> be the set of all five-card poker hands. Let <span class="math inline">A \subseteq U</span> be the set of hands that contain at least one ace.</p>
<p>Hands with <strong>no aces</strong> are formed entirely from the remaining <span class="math inline">48</span> non-ace cards, so there are <span class="math inline">\binom{48}{5}</span> such hands. Since <span class="math inline">|U|=\binom{52}{5}</span>, we obtain</p>
<p><span class="math display">
|A|
=
|U| - |U \setminus A|
=
\binom{52}{5}
-
\binom{48}{5}.
</span></p>
<p>This is inclusion–exclusion with a single exclusion: count everything, then exclude what violates the condition.</p>
<hr>
</section>
</section>
<section id="two-exclusion-steps-overlapping-conditions" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="two-exclusion-steps-overlapping-conditions"><span class="header-section-number">3.4.2</span> Two Exclusion Steps: Overlapping Conditions</h3>
<section id="example-hands-containing-an-ace-or-a-king" class="level4" data-number="3.4.2.1">
<h4 data-number="3.4.2.1" class="anchored" data-anchor-id="example-hands-containing-an-ace-or-a-king"><span class="header-section-number">3.4.2.1</span> Example: Hands Containing an Ace <em>or</em> a King</h4>
<p>Let <span class="math inline">U</span> again denote the set of all five-card hands. Define subsets - <span class="math inline">A \subseteq U</span>: hands containing at least one ace, - <span class="math inline">K \subseteq U</span>: hands containing at least one king.</p>
<p>We want to count the hands containing an ace or a king, that is, the union <span class="math inline">A \cup K</span>.</p>
<p>A natural first step is to add <span class="math inline">|A|</span> and <span class="math inline">|K|</span>, but then any hand that contains both an ace and a king has been counted twice. This suggests the correction</p>
<p><span class="math display">
|A \cup K|
=
|A| + |K| - |A \cap K|.
</span></p>
<p>To compute each term by subtraction from <span class="math inline">|U|</span>, observe:</p>
<ul>
<li><p>As before, <span class="math display">
|A| = \binom{52}{5} - \binom{48}{5},
\qquad
|K| = \binom{52}{5} - \binom{48}{5}.
</span></p></li>
<li><p>The intersection <span class="math inline">A \cap K</span> consists of hands containing at least one ace <em>and</em> at least one king. Its complement in <span class="math inline">U</span> is the set of hands containing <strong>no aces and no kings</strong>, which are chosen from the remaining <span class="math inline">44</span> cards. Hence <span class="math display">
|A \cap K|
=
|U| - \binom{44}{5}
=
\binom{52}{5} - \binom{44}{5}.
</span></p></li>
</ul>
<p>Substituting into the union formula gives <span class="math display">
|A \cup K|
=
\left(\binom{52}{5}-\binom{48}{5}\right)
+
\left(\binom{52}{5}-\binom{48}{5}\right)
-
\left(\binom{52}{5}-\binom{44}{5}\right)
=
\binom{52}{5} - 2\binom{48}{5} + \binom{44}{5}.
</span></p>
<p>This example shows the pattern that will generalize: unions are counted by adding single-set sizes and then subtracting overlaps to correct the overcount.</p>
<hr>
</section>
</section>
<section id="the-general-inclusionexclusion-principle" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="the-general-inclusionexclusion-principle"><span class="header-section-number">3.4.3</span> The General Inclusion–Exclusion Principle</h3>
<p>Let <span class="math inline">U</span> be a finite set, and let <span class="math inline">A_1, A_2, \dots, A_n</span> be subsets of <span class="math inline">U</span>. Then</p>
<p><span class="math display">
\left| \bigcup_{i=1}^n A_i \right|
=
\sum_{i=1}^n |A_i|
-
\sum_{1 \le i &lt; j \le n} |A_i \cap A_j|
+
\sum_{1 \le i &lt; j &lt; k \le n} |A_i \cap A_j \cap A_k|
-
\cdots
+
(-1)^{n+1} |A_1 \cap \cdots \cap A_n|.
</span></p>
<p>The signs alternate. Intuitively, each element lying in several sets gets added multiple times in the first sum, then subtracted multiple times in the second sum, and so on, with the alternating corrections eventually leaving each element counted exactly once.</p>
<hr>
</section>
<section id="proof-by-induction" class="level3" data-number="3.4.4">
<h3 data-number="3.4.4" class="anchored" data-anchor-id="proof-by-induction"><span class="header-section-number">3.4.4</span> Proof by Induction</h3>
<p>We prove the inclusion–exclusion formula by induction on <span class="math inline">n</span>.</p>
<section id="base-case-n1" class="level4" data-number="3.4.4.1">
<h4 data-number="3.4.4.1" class="anchored" data-anchor-id="base-case-n1"><span class="header-section-number">3.4.4.1</span> Base case: <span class="math inline">n=1</span></h4>
<p>If <span class="math inline">n=1</span>, then <span class="math inline">\bigcup_{i=1}^1 A_i = A_1</span>, and the formula reduces to <span class="math display">
|A_1| = |A_1|,
</span> which is true.</p>
</section>
<section id="inductive-step" class="level4" data-number="3.4.4.2">
<h4 data-number="3.4.4.2" class="anchored" data-anchor-id="inductive-step"><span class="header-section-number">3.4.4.2</span> Inductive step</h4>
<p>Assume the formula holds for <span class="math inline">n-1</span> sets. Let <span class="math inline">A_1,\dots,A_{n-1},A_n</span> be subsets of <span class="math inline">U</span>.</p>
<p>Write <span class="math display">
\bigcup_{i=1}^n A_i
=
\left(\bigcup_{i=1}^{n-1} A_i\right)\cup A_n.
</span></p>
<p>Using the two-set counting identity <span class="math display">
|X \cup Y| = |X| + |Y| - |X \cap Y|,
</span> with <span class="math inline">X=\bigcup_{i=1}^{n-1}A_i</span> and <span class="math inline">Y=A_n</span>, we obtain <span class="math display">
\left|\bigcup_{i=1}^n A_i\right|
=
\left|\bigcup_{i=1}^{n-1} A_i\right|
+
|A_n|
-
\left|\left(\bigcup_{i=1}^{n-1} A_i\right)\cap A_n\right|.
</span></p>
<p>Next, distribute the intersection over the union: <span class="math display">
\left(\bigcup_{i=1}^{n-1} A_i\right)\cap A_n
=
\bigcup_{i=1}^{n-1} (A_i \cap A_n).
</span></p>
<p>Now apply the induction hypothesis to the <span class="math inline">n-1</span> sets <span class="math display">
A_1\cap A_n,\ A_2\cap A_n,\ \dots,\ A_{n-1}\cap A_n.
</span></p>
<p>This yields <span class="math display">
\left|\left(\bigcup_{i=1}^{n-1} A_i\right)\cap A_n\right|
=
\sum_{i=1}^{n-1} |A_i\cap A_n|
-
\sum_{1\le i&lt;j\le n-1} |A_i\cap A_j\cap A_n|
+
\cdots
+
(-1)^{n} |A_1\cap\cdots\cap A_{n-1}\cap A_n|.
</span></p>
<p>Also, by the induction hypothesis applied to <span class="math inline">A_1,\dots,A_{n-1}</span>, <span class="math display">
\left|\bigcup_{i=1}^{n-1} A_i\right|
=
\sum_{i=1}^{n-1} |A_i|
-
\sum_{1 \le i &lt; j \le n-1} |A_i \cap A_j|
+
\cdots
+
(-1)^{n} |A_1 \cap \cdots \cap A_{n-1}|.
</span></p>
<p>Substitute both expansions into <span class="math display">
\left|\bigcup_{i=1}^n A_i\right|
=
\left|\bigcup_{i=1}^{n-1} A_i\right|
+
|A_n|
-
\left|\left(\bigcup_{i=1}^{n-1} A_i\right)\cap A_n\right|.
</span></p>
<p>The first two terms contribute all intersections <em>not involving</em> <span class="math inline">A_n</span> (plus the single term <span class="math inline">|A_n|</span>). The final subtraction contributes exactly the intersections <em>involving</em> <span class="math inline">A_n</span>, with the alternating signs reversed by the leading minus sign, producing</p>
<ul>
<li>subtraction of all pairwise intersections <span class="math inline">A_i\cap A_n</span>,</li>
<li>addition of all triple intersections <span class="math inline">A_i\cap A_j\cap A_n</span>,</li>
<li>and so on,</li>
<li>ending with <span class="math inline">(-1)^{n+1}|A_1\cap\cdots\cap A_n|</span>.</li>
</ul>
<p>Collecting terms yields precisely the inclusion–exclusion formula for <span class="math inline">n</span> sets. This completes the induction. ## Inclusion–Exclusion: Correcting Overcounts</p>
<p>Counting by the complement avoids difficult casework by counting what <em>does not</em> happen. Inclusion–exclusion addresses a different but equally common problem: <strong>overcounting</strong>.</p>
<p>It arises whenever objects may satisfy more than one condition simultaneously.</p>
<hr>
</section>
</section>
<section id="computer-science-valid-states-in-a-sea-of-possibilities" class="level3" data-number="3.4.5">
<h3 data-number="3.4.5" class="anchored" data-anchor-id="computer-science-valid-states-in-a-sea-of-possibilities"><span class="header-section-number">3.4.5</span> Computer Science: Valid States in a Sea of Possibilities</h3>
<p>In computer science, counting often begins with a vast theoretical universe and then systematically removes what is not allowed.</p>
<p>Consider a system with <span class="math inline">n</span> binary switches. There are <span class="math inline">2^n</span> possible configurations.<br>
Now impose constraints: - switch 1 and switch 2 cannot both be on, - switch 4 must be on if switch 7 is off, - at least one switch in a given subset must be active.</p>
<p>Each constraint excludes a family of configurations. Constraints overlap. Some configurations violate multiple rules at once.</p>
<p>Counting <em>valid</em> states becomes a problem of: - defining forbidden sets, - counting them, - correcting overlaps via inclusion–exclusion.</p>
<p>This is the same logic used earlier in the chapter to count hands with repeated ranks, or boards with overlapping suit patterns. The stakes are different—system safety, computational feasibility, correctness—but the structure is the same.</p>
<p>Poker asks, “How many hands survive these rules?”<br>
Computer science asks, “How many states survive these constraints?”</p>
<hr>
</section>
<section id="a-shared-mathematical-spine" class="level3" data-number="3.4.6">
<h3 data-number="3.4.6" class="anchored" data-anchor-id="a-shared-mathematical-spine"><span class="header-section-number">3.4.6</span> A Shared Mathematical Spine</h3>
<p>Across these examples, the same questions recur:</p>
<ul>
<li>What distinctions matter?</li>
<li>Which collections are easiest to count directly?</li>
<li>When do constraints overlap?</li>
<li>Where does naïve counting fail?</li>
</ul>
<p>Poker makes these questions tangible because the consequences are immediate and unforgiving. But the mathematics does not belong to poker. It belongs to any discipline that must reason carefully about <em>possibility under constraint</em>.</p>
<p>Counting, in this sense, is not about arithmetic.<br>
It is about structure—and about knowing when intuition needs correction.</p>
</section>
</section>
<section id="liberal-arts-sidebar" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="liberal-arts-sidebar"><span class="header-section-number">3.5</span> Liberal Arts Sidebar</h2>
<p><strong>What Counts as Rare? Counting, Culture, and the Manufacture of Value</strong></p>
<p>When early poker communities disagreed about whether a straight or a flush should be valued more highly, they were not arguing about arithmetic. They were arguing about <em>which experiences deserved authority</em>. A player who spent night after night drawing to four hearts experienced flushes as attainable, even routine. Another, reasoning abstractly across all possible five-card hands, concluded that flushes were scarcer and therefore stronger. Both views were internally coherent. What differed was the frame.</p>
<p>This distinction—between <em>experienced rarity</em> and <em>structural rarity</em>—turns out to be one of the central tensions in the history of counting.</p>
<p>Mathematics gives us tools for enumeration, but it does not tell us which enumeration matters. That decision is cultural, economic, and often political.</p>
<p>A vivid example lies far from the poker table, in the modern history of diamonds. By the late nineteenth century, diamond discoveries in southern Africa had made it clear that diamonds were not naturally scarce in any absolute sense. Left to geological reality, they would have become relatively common. The response of <strong>De Beers</strong> was not to deny abundance, but to reorganize counting itself.</p>
<p>De Beers restricted supply, stockpiled stones, and—most importantly—reframed the question of value. Through one of the most influential advertising campaigns of the twentieth century, diamonds were repositioned as symbols of permanence, fidelity, and moral seriousness. “A diamond is forever” did not merely suggest durability. It implied singularity. The relevant question ceased to be “How many diamonds exist?” and became “How many moments in a life justify one?”—with the socially enforced answer being exactly one.</p>
<p>In this new frame, diamonds did not need to be geologically rare. They needed to be <em>ritually rare</em>. Counting shifted from inventories to life events. Value followed.</p>
<p>Poker works the same way. A flush is not inherently stronger than a straight. It becomes stronger when a community agrees that rarity should be measured globally rather than locally, abstractly rather than experientially. Once that agreement hardens into convention, the hierarchy feels natural, even obvious. What began as a contested judgment becomes a rule.</p>
<p>Across cultures, however, the introduction of large-scale counting has often been met with resistance—not because people could not count, but because counting changes what counts <em>as knowledge</em>.</p>
<p>Anthropologists have documented societies in which precise enumeration is deliberately limited. Among the Pirahã of the Amazon, traditional language emphasizes relative quantities—“few,” “some,” “many”—rather than exact numbers. This is not a deficiency. It reflects an epistemology grounded in immediacy and relation. Counting beyond what can be acted upon offers no additional insight and may even mislead. Abstract totals sever knowledge from experience.</p>
<p>Similar patterns appear in Inuit hunting cultures, where ecological understanding historically centered on ice conditions, animal behavior, and seasonal rhythms rather than population counts. Hunters did not need to know how many seals existed in the abstract; they needed to know when, where, and how to hunt responsibly. Enumeration without context risked replacing attentiveness with false certainty.</p>
<p>In Melanesia, early colonial efforts to survey and measure land were resisted not because measurement was incomprehensible, but because it transformed land from a relational inheritance into a commodity. To count land was to make it alienable, taxable, and governable by distant authorities. Quantization was not neutral bookkeeping; it was an assertion of power.</p>
<p>Even within Europe, the rise of censuses and actuarial tables provoked unease. To be counted was to become legible—to taxation, conscription, insurance, and regulation. Numerical governance promised fairness and efficiency, but it also threatened to flatten moral and social distinctions. Death became a rate. Risk became a premium. Individuals became entries in tables.</p>
<p>Across these cases, resistance to counting follows a common pattern. Quantization: - replaces narrative with aggregation, - shifts authority from local judgment to abstract systems, - and redefines value in ways that may conflict with lived meaning.</p>
<p>This resistance is not anti-mathematical. It is ethical and epistemological. It asks not whether numbers are correct, but whether they are <em>entitled</em> to decide.</p>
<p>Poker compresses this long history into a single, teachable question: <em>Which rarity should matter?</em><br>
The rarity we feel? The rarity we remember? Or the rarity that emerges only when all possibilities are laid out at once?</p>
<p>Combinatorics and probability do not answer this question for us. They provide the machinery to count, but communities decide which counts become authoritative. That decision reshapes value—whether at a card table, in a marketplace, or across a society.</p>
<p>To learn counting, then, is not merely to master technique. It is to become aware of the frames we adopt, the perspectives we privilege, and the meanings we risk erasing when numbers begin to speak in our place.</p>
</section>
<section id="homework-problems" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="homework-problems"><span class="header-section-number">3.6</span> Homework Problems</h2>
<ol type="1">
<li><p>Prove that <span class="math display">
\binom{n}{k} = \binom{n}{n-k}
</span> using a counting argument (not algebraic manipulation). Interpret this identity in the context of choosing cards from a deck.</p></li>
<li><p>Prove Pascal’s identity <span class="math display">
\binom{n}{k} = \binom{n-1}{k} + \binom{n-1}{k-1}
</span> by partitioning a collection of <span class="math inline">k</span>-element subsets into two disjoint classes. Explain the underlying “either–or” decision being counted.</p></li>
<li><p>Prove that <span class="math display">
\sum_{k=0}^n \binom{n}{k} = 2^n
</span> by interpreting both sides as counting the same set in two different ways.</p></li>
<li><p>Prove that <span class="math display">
\sum_{k=0}^n (-1)^k \binom{n}{k} = 0
</span> for <span class="math inline">n \ge 1</span> using a combinatorial argument rather than the binomial theorem.</p></li>
<li><p>Count the number of five-card poker hands that contain <em>exactly one pair</em>. Carefully justify that no other hand types are included.</p></li>
<li><p>Count the number of five-card poker hands that contain <em>exactly two distinct pairs</em>. Explain why your count excludes full houses.</p></li>
<li><p>Count the number of five-card flushes that are <em>not</em> straight flushes. Clearly describe how straight flushes are excluded.</p></li>
<li><p>Count the number of five-card straights. Explicitly state how the ace is treated in your model.</p></li>
<li><p>Using your answers to the previous two problems, explain mathematically why flushes outrank straights in standard poker hand rankings.</p></li>
<li><p>Count the number of distinct flops in Texas Hold’em that contain at least one repeated rank.</p></li>
<li><p>Count the number of distinct flops in Texas Hold’em that contain at least two cards of the same suit.</p></li>
<li><p>Count the number of five-card boards (flop–turn–river) that contain <em>exactly two hearts</em>.</p></li>
<li><p>Count the number of five-card boards that contain at least one ace and at least one heart.</p></li>
<li><p>At a six-handed Texas Hold’em table, count the number of hole-card assignments in which <em>at least one player</em> is dealt a pocket pair.</p></li>
<li><p>At a six-handed Texas Hold’em table, count the number of hole-card assignments in which <em>no player</em> is dealt a pocket pair.</p></li>
<li><p>A species has <span class="math inline">r</span> genes, each with two possible alleles.</p>
<ol type="a">
<li>Count the number of possible genotypes if allele order matters.<br>
</li>
<li>Count the number of possible genotypes if allele order does not matter.<br>
Explain the structural difference between the two models.</li>
</ol></li>
<li><p>A population is classified according to three overlapping traits. Explain how to count the number of individuals possessing at least one trait, and why naïve addition necessarily overcounts.</p></li>
<li><p>A system has <span class="math inline">n</span> binary switches, but configurations in which switches 1 and 2 are both on are forbidden. Count the number of valid configurations.</p></li>
<li><p>Three tasks must be assigned to five distinct time slots, with the restriction that no two tasks may occupy adjacent slots. Count the number of valid schedules.</p></li>
<li><p>Count the number of binary strings of length <span class="math inline">n</span> that contain at least one occurrence of the substring “11”.</p></li>
<li><p>Invent a new five-card hand ranking system based on a different notion of rarity (for example, rarity conditioned on partial information). Explain how your ranking could be justified mathematically.</p></li>
<li><p>Give an example of a poker situation in which conditioning on known cards dramatically changes which outcomes appear rare. Explain how this differs from global counting.</p></li>
<li><p>Identify a poker counting problem in which two different modeling choices lead to two different correct answers. Explain what information each model preserves.</p></li>
<li><p>Reflect on how counting can <em>create</em> value rather than merely measure it. Use one example from poker and one example from outside poker.</p></li>
</ol>
</section>
<section id="extension-activity" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="extension-activity"><span class="header-section-number">3.7</span> Extension Activity</h2>
<p>Write a short program that uses random simulation to estimate how often each five-card hand type occurs, and then compare your simulated frequencies to the exact frequencies obtained by counting.</p>
<p>Begin by choosing a programming environment (R, Python, Julia, or another language you know). Your program should represent a standard 52-card deck, repeatedly generate random five-card hands <em>without replacement</em>, classify each hand by its ranking, and record counts. You may treat the ordering of the five cards as irrelevant, but your code should be explicit about how it generates hands and how it avoids duplicates within a hand.</p>
<p>Your simulation should estimate the relative frequencies of at least the following categories: high card, one pair, two pair, three of a kind, straight, flush, full house, four of a kind, and straight flush. You should explain, in words, how your classifier distinguishes between these categories and how it handles special cases such as the ace being low in a <span class="math inline">A</span>–<span class="math inline">2</span>–<span class="math inline">3</span>–<span class="math inline">4</span>–<span class="math inline">5</span> straight.</p>
<p>Run the simulation for several different sample sizes (for example <span class="math inline">10^4</span>, <span class="math inline">10^5</span>, and <span class="math inline">10^6</span> hands). For each run, report a table showing the estimated frequency of each hand type. Then compute the exact counts for each hand type using analytic methods from the chapter, and convert those counts into exact proportions by dividing by <span class="math inline">\binom{52}{5}</span>. Create a second table that places simulated estimates and exact values side by side, and include the absolute error for each category.</p>
<p>To connect simulation back to mathematical reasoning, include a short discussion addressing the following questions. Which hand categories converge most quickly to their exact proportions, and which converge slowly? How does the rarity of an event affect the reliability of its estimate? If a category occurs very rarely (such as straight flushes), what would you need to change about your simulation to estimate its frequency accurately?</p>
<p>Finally, reflect on the relationship between analytic counting and simulation. When is simulation a useful substitute for exact counting, and when is it misleading? Identify one feature of poker counting (for example overlaps between straights and flushes, or the treatment of ace-low straights) where writing correct code forces you to be mathematically precise.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/01-poker-games-structure-and-language.html" class="pagination-link" aria-label="Poker Games, Structure, and Language">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Poker Games, Structure, and Language</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/03-poker-as-a-probability-space.html" class="pagination-link" aria-label="Poker as a Probability Space">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Poker as a Probability Space</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>